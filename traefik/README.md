## 访问 dashboard 返回 404

1. 在 deployment 中修改 traefik arg 添加`- '--api.insecure=true'`

```yaml
spec:
  template:
    spec:
      containers:
        args:
          - '--api.insecure=true' # 缺少这个
          - '--providers.kubernetesingress' # 一般有
```

需要为 ssl 添加证书 为访问 dashboard 添加认证

```yaml
apiVersion: traefik.io/v1alpha1
kind: TLSStore
metadata:
  name: default
  namespace: kube-system

spec:
  defaultCertificate:
    secretName: tls-cert
---
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: access-auth
  namespace: kube-system
spec:
  basicAuth:
    secret: authsecret
---
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: traefik-dashboard
  namespace: kube-system
spec:
  entryPoints:
    - websecure
  routes:
    - kind: Rule
      match: Host(`kougen.asia`) && (PathPrefix(`/dashboard`) || PathPrefix(`/api`))
      services:
        - kind: TraefikService
          name: api@internal
      middlewares:
        - name: access-auth
```

```yaml
apiVersion: v1
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUdjVENDQk5tZ0F3SUJBZ0lRUm91R3RIQjBHMG00QTczNGEvSCswekFOQmdrcWhraUc5dzBCQVF3RkFEQloKTVFzd0NRWURWUVFHRXdKRFRqRWxNQ01HQTFVRUNoTWNWSEoxYzNSQmMybGhJRlJsWTJodWIyeHZaMmxsY3l3ZwpTVzVqTGpFak1DRUdBMVVFQXhNYVZISjFjM1JCYzJsaElGSlRRU0JFVmlCVVRGTWdRMEVnUnpJd0hoY05Nak13Ck9ETXhNREF3TURBd1doY05NalF3T0RNd01qTTFPVFU1V2pBV01SUXdFZ1lEVlFRREV3dHJiM1ZuWlc0dVlYTnAKWVRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTTJUQVFsZUpUcTI0VktPdE9yZQpHbC9rQXBYTzliamhSRWl0RzBXOHMvb2djQWlWKytwMU5hNmxjTTNLSnRSRTkzMG15cVNqVkNXWWJFOVM3UEM0CjJIei9pZzRGOExJeUZnZTVlbkY1eVZxL2MrbFpkdUpxT1RRL0NGSkdRcUwrbksvNjVKSWE2NTBqclBzVGVxcXAKTjVmajF5OG1aOFFhSXNsV1IxTC95RG54Zm1OdDNXUXVESTNhOHpZd2xDNXU4U05JNDRicG1rQjJZNUpGMnhtZwpkKzhJR3JmOUFRUDNYNjlWYU1ZWW1LZDk3Z0ZiY3JqZ3NRUEVRb2QxZHdCZHNWR2JlTmFyR3hWemcwS1hLTmhNCmw1ekFNNTlya2EvY0NBOGtNbmZOMVBtcXFzRDd6SStvV3JDam4weGFVVDgycU1ONnZrV2NkaTFuRitKZThIS2sKNVIwQ0F3RUFBYU9DQXZZd2dnTHlNQjhHQTFVZEl3UVlNQmFBRkY4NmZCRVFmZ3huY1dIY2k2TzFBQU5uOVZjYwpNQjBHQTFVZERnUVdCQlNyZElQNXNVRmkyU3haUDVxV0lETzA5Z1pGUURBT0JnTlZIUThCQWY4RUJBTUNCYUF3CkRBWURWUjBUQVFIL0JBSXdBREFkQmdOVkhTVUVGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd1NRWUQKVlIwZ0JFSXdRREEwQmdzckJnRUVBYkl4QVFJQ01UQWxNQ01HQ0NzR0FRVUZCd0lCRmhkb2RIUndjem92TDNObApZM1JwWjI4dVkyOXRMME5RVXpBSUJnWm5nUXdCQWdFd2ZRWUlLd1lCQlFVSEFRRUVjVEJ2TUVJR0NDc0dBUVVGCkJ6QUNoalpvZEhSd09pOHZZM0owTG5SeWRYTjBMWEJ5YjNacFpHVnlMbU51TDFSeWRYTjBRWE5wWVZKVFFVUlcKVkV4VFEwRkhNaTVqY25Rd0tRWUlLd1lCQlFVSE1BR0dIV2gwZEhBNkx5OXZZM053TG5SeWRYTjBMWEJ5YjNacApaR1Z5TG1OdU1DY0dBMVVkRVFRZ01CNkNDMnR2ZFdkbGJpNWhjMmxoZ2c5M2QzY3VhMjkxWjJWdUxtRnphV0V3CmdnRitCZ29yQmdFRUFkWjVBZ1FDQklJQmJnU0NBV29CYUFCM0FIYi9pRDhLdHZ1VlVjSmh6UFdIdWpTMHBNMjcKS2R4b1FncWY1bWRNV2pwMEFBQUJpa3hqc1FVQUFBUURBRWd3UmdJaEFMNHZ1L0QwVW5qQ3M2NkhxMVlBSmlINQovMmt6eFVBeCtCTExlUDM4QUZDSEFpRUEzVkpEZXRzenhmdThjQVRWTlF6V2pSdHczNWIzd2xaUEsrM2dKV1BXClF2Z0FkZ0RhdHI5clA3VzJJcCtid3J0Y2EraHdrWEZzdTFHRWhUUzlwRDB3U05mN3F3QUFBWXBNWTdGakFBQUUKQXdCSE1FVUNJUUQzZWdOOWZwSktpcUErM0h0WlA4ajVkYVhOUk1YTWZkWmYrUWRvVlVuMklBSWdUVk1mZ0RWNApXY1A5ak9Ibm9UTEhDY2hid1dMekJIK1JLVHBUY1BiYzlNVUFkUUR1emRCazFkc2F6c1ZjdDUyMHpST2lNb2RHCmZMenMzc05SU0ZsR2NSKzFtd0FBQVlwTVk3RXJBQUFFQXdCR01FUUNJR1JUcXpsbWp2czNheDBVeDBwd1N0WDIKVXFBWEZiM3pwa3ZXbmJRc1ZyNWxBaUJNVWNmOWxXaVVLak5hYkRZVUhWckluYmVtdXdGV1JxUzRybDVVRnI5RgpLakFOQmdrcWhraUc5dzBCQVF3RkFBT0NBWUVBZXJTU1JxdDJpOVVKak42VStiV1VvZS91d1dUbmJpNzlVdlNiCitlNU80V2o1emtpcEF2ZEZEQXVwK1hveWFNdzZNV2tLb3JtMElOOEVsL2hUQzlONnFwb0FBMk5RVmJaS2IvT3cKNURTQlBXeXVISkJPVTZ2WUNlc0RrWmNIZ1F6WDk1cHRQbFM0ck1NQkdSVnMrdmdpUHRtZTVsWVQ2NyttNktjdQpRN2tzbWpxenpDM1pnZnpid2U0aGF2NTdjWTdrdUtFcGU4UkxnN0llQWdGZ2xtMGgyZ1cyRkMxemRYWGhVZUJUCk1QQXh2SzdNWFdiNTFBakhwVlJZdEU3Vkt5emcycnNkS2N6VzZQVU51QUtBRnF1eVBoNDkyS0NpUVgvNVllcEIKRmY5eFllVWJ5Y3ZIRzJZVm9BZzRoaDVJUGR0dzgza21qQjFQU3pDNyt3RGZKQ1dOVEFPNDJUd2poWUIvK3c1QQpIeWdjb0xGUS9sZFlxNnRNNk1tLzdqMkFYb2wxMHAyNEJUdGhVQms5WlV4Qkwwb0FycjFXQzRXQ2xpbGQ5OFFDCkZXcTFuQlY4WjAzcGVlZ3RWdTRHOHE1NkNNWUsxTjVROVpyR21pRWRabnNuZnZvRTdJUGE5dUJ6Q1VhVU5OVWQKWlg1TnA5bzdBNEJTbWlmdldMd3NBcXQxQURJMwotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCi0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQpNSUlGQnpDQ0ErK2dBd0lCQWdJUkFMSU03VlV1TWFDL05EcDFLSFE3NmFzd0RRWUpLb1pJaHZjTkFRRUxCUUF3CmV6RUxNQWtHQTFVRUJoTUNSMEl4R3pBWkJnTlZCQWdNRWtkeVpXRjBaWElnVFdGdVkyaGxjM1JsY2pFUU1BNEcKQTFVRUJ3d0hVMkZzWm05eVpERWFNQmdHQTFVRUNnd1JRMjl0YjJSdklFTkJJRXhwYldsMFpXUXhJVEFmQmdOVgpCQU1NR0VGQlFTQkRaWEowYVdacFkyRjBaU0JUWlhKMmFXTmxjekFlRncweU1qQXhNVEF3TURBd01EQmFGdzB5Ck9ERXlNekV5TXpVNU5UbGFNRmt4Q3pBSkJnTlZCQVlUQWtOT01TVXdJd1lEVlFRS0V4eFVjblZ6ZEVGemFXRWcKVkdWamFHNXZiRzluYVdWekxDQkpibU11TVNNd0lRWURWUVFERXhwVWNuVnpkRUZ6YVdFZ1VsTkJJRVJXSUZSTQpVeUJEUVNCSE1qQ0NBYUl3RFFZSktvWklodmNOQVFFQkJRQURnZ0dQQURDQ0FZb0NnZ0dCQUtqR0RlMEdTYUJzCllsL1ZoTWFUTTZHaGZSMVRBdDRtcmhOOHpmQU13RWZMWnRoK04yaWU1VUxiVzhZdlNHemhxa0RoR2dTQmxhZm0KcXEwNW9lRVNySUpReXoyNGo3aWNHZUd5SVovaklDaE9Pdmp0NE04RVZpM08wU2U3RTZSQWdWWWNYK1FXVnA1YwpTeStsN1hycnRML3BEREw5Qm5nbnEvRFZmakN6bTVaWVViMVBweXZZVFA3dHJzVit5WU9DTm1td1F2QjR5VmpmCklJcEhDMU9jc1BCbnRNVUdlSDFFamE0RCtxSlloR094WDlrcGErMndUQ1cwNkw4VDZPaGtwSldZbjVKWWlodDUKOGV4akFSN2I4WmkzRGVHOW9aTzVvNlF2aGwzZjh1R1U4bEsxajlqQ1VOLzE4bUkvNXZaSjc2aStoc2dkbGZaQgpSaDVsbUFRakQ4ME05VFkrb0Q0TVlVcUI1WHJpZ1BmRkFVd1hGR2VoaGx3Q1Z3N3k2KzVrcGJxL05wdk01QmE4ClNlUVlVVXVNQThSWHBUdEdscnJUUHFKcnlmYTU1aFR1WC9UaGhYNGdjQ1ZrYnl1am8wQ1lyK1V1YzE0SU95TlkKMWZEMC9xT1JibGxiZ1Y0MXdpeS8yWlVXWlFVb2RxSFdralQxQ3dJTWJRT1k1am1yU1lHQnd3SURBUUFCbzRJQgpKakNDQVNJd0h3WURWUjBqQkJnd0ZvQVVvQkVLSXo2VzhRZnM0cThwNzRLbGY5QXdwTFF3SFFZRFZSME9CQllFCkZGODZmQkVRZmd4bmNXSGNpNk8xQUFObjlWY2NNQTRHQTFVZER3RUIvd1FFQXdJQmhqQVNCZ05WSFJNQkFmOEUKQ0RBR0FRSC9BZ0VBTUIwR0ExVWRKUVFXTUJRR0NDc0dBUVVGQndNQkJnZ3JCZ0VGQlFjREFqQWlCZ05WSFNBRQpHekFaTUEwR0N5c0dBUVFCc2pFQkFnSXhNQWdHQm1lQkRBRUNBVEJEQmdOVkhSOEVQREE2TURpZ05xQTBoakpvCmRIUndPaTh2WTNKc0xtTnZiVzlrYjJOaExtTnZiUzlCUVVGRFpYSjBhV1pwWTJGMFpWTmxjblpwWTJWekxtTnkKYkRBMEJnZ3JCZ0VGQlFjQkFRUW9NQ1l3SkFZSUt3WUJCUVVITUFHR0dHaDBkSEE2THk5dlkzTndMbU52Ylc5awpiMk5oTG1OdmJUQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFITVVvbTVjeElqZTJJaUZVN21PQ3NCcjJGNkNZCmVVNWN5ZlEvQWVwOWtBWFlVRHVXc2FUODU3MjFKeGVYRllrZjREL2NnTmQ5K2h4VDhaZURPSnJuK3lzcVI3Tk8KMks5QWRxVGRJWTJ1WlBLbXZnSE9rdkgyZ1FENmpjMDVlU1BPd2RZLzEwSVB2bXBnVUthR09hL3R5eWdMOE9nNAozdFl5b0hpcE1NblM0T2lZS2FrREpueTBYVnVjaElQN1pNS2lQMDdRM0ZJdVNTNG9telI3N2ttYzc1LzZROWRQCnY0d2E5MFVDT24xajZyN1doTW1YM2VUM0dzZGozV01lOWJZRDBBRnVxYTZNRHlqSWVYcTA4bVZHcmFYaXc3M3MKWmFsZThPTWNrbi9CVTNPLzNhRk5MSExmRVQySDJoVDZXYjNud3hqcExJZlhtU1ZjVmQ4QTU4WEgwZz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0=
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQ0KTUlJRW9BSUJBQUtDQVFFQXpaTUJDVjRsT3JiaFVvNjA2dDRhWCtRQ2xjNzF1T0ZFU0swYlJieXoraUJ3Q0pYNw0KNm5VMXJxVnd6Y29tMUVUM2ZTYktwS05VSlpoc1QxTHM4TGpZZlArS0RnWHdzaklXQjdsNmNYbkpXcjl6NlZsMg0KNG1vNU5EOElVa1pDb3Y2Y3IvcmtraHJyblNPcyt4TjZxcWszbCtQWEx5Wm54Qm9peVZaSFV2L0lPZkYrWTIzZA0KWkM0TWpkcnpOakNVTG03eEkwampodW1hUUhaamtrWGJHYUIzN3dnYXQvMEJBL2RmcjFWb3hoaVlwMzN1QVZ0eQ0KdU9DeEE4UkNoM1YzQUYyeFVadDQxcXNiRlhPRFFwY28yRXlYbk1Bem4ydVJyOXdJRHlReWQ4M1UrYXFxd1B2TQ0KajZoYXNLT2ZURnBSUHphb3czcStSWngyTFdjWDRsN3djcVRsSFFJREFRQUJBb0gvTEpFeUtGWEF2SG5wWDN5UQ0KdkZwcVhWK1JMK2t1WEdaNTUwZWdJZjVIQm5NQjF0cXRRcWNtZkRaaHZqdVZMMi9FTjkyeEVRQlh2YzdOckdUTg0KK1dJWmpQL1piakRiZmNaZUFFNjF2T1FxUXdJK250aEdiYytabHpvVEU4TW5yeTZEeWFNYTZwSHJncVc1V3JWZQ0KWXFGTTdDRDVCYi9OdnpYclZMcmZ1NTY0U2RjdGx2SFdFWm40Wk95M3gxRENoSU9uMTlLN1NQUUFtWTVkanExSA0KaldZbjJkbXpycEQ3djhHLzdSSlpxZUNZVnBaYXhCL2ZkYTE3Y0V2SHF6ZlViVHhaQ1RtTWpGdGRtRkdTTmdPaA0KanREdTQ3RmpBcm96RHpUWTJEM1F5am5tN1IwaWZQenZRbkR0VmwwQ3Z6QWtYZG5qOWRoZ0VubHprUm9zTHByRg0KOGNSQkFvR0JBT2F2UlFQN012bDl2enNyRWhIUU5DV0pmaUc5Sy91Q0tQcG4xbC9oMnlKa3RTTTM4UldwQW9uSg0KeTZxRzRQbmlDTVpvbG81SmtBOEpIMUM3R2gyRFExai8zOGVEQTJXZENDS2E4Mm1DTzFtd2NzQVZRUnJFS3pCMg0KaTlScWdZcVFkamZQdTBsQkdpRnlHQVliTUhkbWxMY3JtV1NlUExabnJTSldmT3RkNG1sOUFvR0JBT1FpUzhrMA0KT1NvbFdYalY2NWZsQ1pCTGViRWxKQlFlNWNtQjRUNHlWYXdHMWk2ejJybDMxSTJPdU9hczNzbVl5K2V5UEMzWg0KTEFBQVI2OFQzSUpWbCt6NXdqZ2pxQnNyZGlTTjRIQ1c0eWczMUQvY3FxWUh6UE1KTWlhT1FpNElSRS9naXF1dA0Kci9VVHNUTTAyL0wycFY3YiszcFN1K1I3clZMTExsV1RiRHdoQW9HQUxQbFV3ajd5SkRRQTJWOC9TWnZHM3Q2Yw0KYWFXQThxcmdwRmtrTVZOT0xybGxtelVuMm1vMTVYa2pMTjdZODc2K3FUZnd5bExMTkRNNkdMb3hrRGxzSXVqWA0KendUYTM2K3F5MXhjUW1DeWczemtFbERTZlk1clFTcUxmbUU1V2pOcDZOMm1ETlVWYkJuYlZ5MXIySXQyU1BQRw0KRnhqR2kyVlJHdFd6eXd0bHZkMENnWUJGWk1WR3c3THJ4Z2FzUWUzeSswRm9lZnpmVEp2bjN1b28zSEFHZWtzag0KRThWTTJYcWIxZjU2dk1JenNMdm4rS2wxcGZxMk80d3R4K2dHTW5WdDA5bHR4UjgxOG1xdE1SQXoyRkJBRHpXeg0Kd3grMStVcVRUR1lrTzFUYzg0TGYrN1hEMGxwOEZFNGtyMFBFZnJ5MDhCK25kaVROdGFMZndsc2JoeUJsK1h6Lw0KNFFLQmdHbk9GZHFod0pVU3phMWppaUdrZTFPY2pYMEFtZGFvTXZoalYrcHlLUEh0UXpFK0JCMWVsc28zRTRtWg0Kd1VIS2ZIWmhBQnl0amd0ajRsU2NERXZhTlNqMENzNWpzY3h4TlBEb1Y2NEkrZnFGU25xb0M5d2VkOXVQeFRxVg0KZE9VYVkwT2Iycklxd3R2UFcvYVFBQWwyNThOeC8xVms5Wi95Q0lWa3VlSmMzUTNzDQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQ0K
kind: Secret
metadata:
  name: tls-cert
  namespace: kube-system
type: kubernetes.io/tls
---
apiVersion: traefik.io/v1alpha1
kind: TLSStore
metadata:
  name: default
  namespace: kube-system

spec:
  defaultCertificate:
    secretName: tls-cert
---
apiVersion: v1
kind: Secret
metadata:
  name: authsecret
  namespace: kube-system
type: kubernetes.io/basic-auth
data:
  username: dXNlcg== # username: user
  password: cGFzc3dvcmQ= # password: password
```
